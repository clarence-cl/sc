<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <link rel="stylesheet" href="css/swiper-3.4.2.min.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/rest.css">
    <script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="js/swiper-3.4.2.jquery.min.js"></script>
    <script type="text/javascript" src="js/rem.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
</head>
<body>
    <a class="toTop" href="javascript:;"></a>
   <div class="container">
    <div class="swiper-container">
      <div class="swiper-wrapper">
      </div>
      <div class="swiper-pagination swiper-pagination-white"></div>
      <div class="search_box">
          <div class="search">
              <img src="images/search.png">
              <input id="search" type="text" placeholder="搜索" name="search">
          </div>
          <img class="user" src="images/my_w.png">
      </div>
    </div>
    <ul class="nav">
        <li>
            <a href="http://www.youtasc.com/shops/client/toPinTuanList.action">
            <img src="images/pt.png">
            <text>拼团</text>
            </a>
        </li>
        <li>
            <a href="http://www.youtasc.com/shops/client/toGoodsList.action?categoryId=76b96799ca6545baa81a9ca76f71b03e">
            <img src="images/jf.png">
            <text>家纺</text>
            </a>
        </li>       
         <li>
            <a href="http://www.youtasc.com/shops/client/toGoodsList.action?categoryId=7798ed1a828e4f80b62fc3104e8ad725">
            <img src="images/jj.png">
            <text>家居</text>
        </a>
        </li>    
        <li>
        <a href="http://www.youtasc.com/shops/client/toGoodsList.action?categoryId=3ce13ad77e2b4321923558e6b97a6f04">
            <img src="images/yd.png">
            <text>运动</text>
        </a>
        </li>        
        <li>
            <a href="http://www.youtasc.com/shops/client/toGoodsList.action?categoryId=4ab179fa47234d53919a101bae7390f1">
            <img src="images/mz.png">
            <text>美妆</text>
            </a>
        </li>        
        <li>
            <a href="http://www.youtasc.com/shops/client/toGoodsList.action?categoryId=5e8b886939c143c2acce17ba1dfde00f">
            <img src="images/sh.png">
            <text>生活</text>
            </a>
        </li>        
        <li>
            <a href="http://www.youtasc.com/shops/client/toGoodsList.action?categoryId=d6d50543e0bb47099252480172fa674c">
                <img src="images/sp.png">
                <text>食品</text>
            </a>
        </li>        
        <li>
            <a href="http://www.youtasc.com/shops/client/toGoodsList.action?categoryId=075aaacb99854db6b1fc345515c542e5">
            <img src="images/muy.png">
            <text>母婴</text>
            </a>
        </li>
        <li>
            <a href="http://www.youtasc.com/shops/client/toGoodsList.action?categoryId=f9631fafc54d4d728b512054202acf46">
            <img src="images/sj.png">
            <text>手机</text>
            </a>
        </li>
        <li>
            <a href="http://www.youtasc.com/shops/client/toGoodsList.action?categoryId=622e39135eb540a98b982911a8fbdc52">
            <img src="images/jd.png">
            <text>家电</text>
            </a>
        </li>
    </ul>
    <a class="advert" href="javascript:;">
        <img src="images/banner.png">
    </a>
    <div class="activity">
        <a href="http://www.youtasc.com/shops/client/toPinTuanList.action" class="activity_1">
            <img src="images/zzpt.png">
        </a>
        <a href="http://www.youtasc.com/shops/client/toGoodsList.action?categoryId=76b96799ca6545baa81a9ca76f71b03e" class="activity_1">
            <img src="images/yttj.png">
        </a>
    </div>
    <div class="box">
        <div>
            <a href="http://www.youtasc.com/shops/client/toGoodsDetail.action?goodsId=50b7b42e8b1545f286ed2a405431fbea">
            <img src="images/yhdp.png">
            </a>
        </div>
        <div class="box2">
            <a href="http://www.youtasc.com/shops/client/toGoodsList.action?categoryId=7798ed1a828e4f80b62fc3104e8ad725">
            <img src="images/jjzq.png">
            </a>
        </div>
        <div>
            <a href="http://www.youtasc.com/shops/client/toGoodsList.action?categoryId=622e39135eb540a98b982911a8fbdc52">
            <img src="images/jdzq.png">
            </a>
        </div>
    </div>
    <div class="like">
    </div>
     <div class="goodslist">
     </div>
      <div class="rx"></div>
        <div class="rxgoodslist"></div>
         <div class="loading">
            <span>正在加载...</span>
            <img src="images/load.gif">
        </div>
   </div>
    <ul class="navbar">
        <li>
            <a href="">
            <span class="home"></span>
            <span>首页</span>
            </a>
        </li>
        <li>
            <a href="http://www.youtasc.com/shops/client/toDiscover.action">
            <span class="find"></span>
            <span>发现</span>
            </a>
        </li>
        <li>
            <a href="http://www.youtasc.com/shops/client/toShoppingCart.action">
            <span class="shop"></span>
            <span>购物车</span>
            </a>
        </li>
        <li>
            <a href="http://www.youtasc.com/shops/client/toMine.action">
             <span class="my"></span>
            <span>我的</span>
            </a>
        </li>
    </ul>
</body>
<script type="text/javascript">
     var onoff = true; 
     var a_url = "http://www.youtasc.com"
window.onload=function(){  
    // $(".goods").each(function(index){
    //     console.log(index)
    //     if(index<=5){
    //         $(".hot").show()
    //     }
    // })
    
    // 
    $(".user").click(function(){
        window.location.href = "http://www.youtasc.com/shops/client/toMine.action";
    })
     getBannerInfo()
       $(".toTop").click(function(){
           $("html,body").animate({scrollTop:0}, 500);
       }) 
    $($(document)).scroll(function() {
      if($(document).scrollTop()>=200){
         $(".search_box").css("background","#fff")
         $(".search").css("background","#e8e8e8")
         $(".user").attr("src","images/my.png")
      }else{
        $(".search_box").css("background","transparent")
        $(".search").css("background","rgba(255,255,255,0.9)")
        $(".user").attr("src","images/my_w.png")
      }
    });  
      var pagenum = 3;
    $(document).scroll(function() {
         if($(window).height()+$(document).scrollTop()>=$(document.body).height()){
            $(".loading").show()
            if (onoff) {
                onoff=false
                setTimeout(function(){
                    pagenum++
                    getHotGoods(pagenum)
               },2000)

            }
         }

      
 })
    // to 详情

    $(".goods").on('click',function(){
        let goodsId = $(that).attr("id")
                window.location.href = "http://www.youtasc.com/shops/client/toGoodsDetail.action?goodsId=" + goodsId;  
    })
}
   function toMine() {
        if ('<%=userId%>' == 'null' || '<%=userId%>' == '') {
            window.parent.parent.location.href = "http://www.youtasc.com/shops/client/toLogin.action";
            return;
        }
        window.location.href = "http://www.youtasc.com/shops/client/toMine.action";
    }

//热门推荐
     function getHotGoodsInfo() {
        var goodsJsondata = {
            page:1,
            rows:20
        };
        $.ajax({
            "url": "http://www.youtasc.com/shops/client/goodsListByTopCategory.action",
            "type": "post",
            "contentType": "application/json;charset=utf-8",
            "data": JSON.stringify(goodsJsondata),
            "dataType": "json",
            "success": function (data) {
               var goodsData = data.rows
                for (i = 0; i < goodsData.length; i++) {
                    var market_value = ((goodsData[i].goods_sn).slice(9,11)*2+goodsData[i].settlement_fee*1).toString()
                     var search_ = parseInt(market_value).toString().substr(-1,1)
                    if(parseInt(market_value)%2==0){
                       var market_pir=parseInt(market_value).toString().replace(search_,"8")
                    }else{
                       var market_pir=parseInt(market_value).toString().replace(search_,"9")
                    }
                var coll =parseInt((goodsData[i].goods_sn).slice(10,11)*goodsData[i].settlement_fee)
               let goodsTemplate = '<a href="http://www.youtasc.com/shops/client/toGoodsDetail.action?goodsId='+goodsData[i].goods_id+'" class="goods" index="'+[i]+'"><img class="goodsImg" src="'+goodsData[i].goods_cover_url+'"><p class="goodsname"><span><b><i class="hot">热卖</i>'+goodsData[i].goods_name+'</b></span></p><div class="price"><span>市场价:￥'+market_pir+'</span><span></span></div><div class="rate"><span>￥'+goodsData[i].settlement_fee+'</span><p class="coll"><span>'+coll+'</span><img src="images/q.png"/></p></div></a>'
               $(goodsTemplate).appendTo($('.goodslist'))
                if(i<=5){
                            $(".hot").show()
                        }
             }
            },
            error: function () {
                console.log("错误")
            }
        });
    }
getHotGoodsInfo()
//热销
     function getHotGoods(num) {
        
        var goodsJsondata = {
            page:4,
            rows:10
        };
        $.ajax({
            "url": a_url+"/shops/client/goodsListByTopCategory.action",
            "type": "post",
            "contentType": "application/json;charset=utf-8",
            "data": JSON.stringify(goodsJsondata),
            "dataType": "json",
            "success": function (data) {
                onoff=true
                $(".loading").hide()
               var goodsData = data.rows
               if (num>=Math.ceil((data.total-20)/10)) {
                $(".loading").html("<span>我也是有底线的<span>").show()}
                for (i = 0; i < goodsData.length; i++) {
                    var market_value = ((goodsData[i].goods_sn).slice(9,11)*2+goodsData[i].settlement_fee*1).toString()
                     var search_ = parseInt(market_value).toString().substr(-1,1)
                    if(parseInt(market_value)%2==0){
                       var market_pir=parseInt(market_value).toString().replace(search_,"8")
                    }else{
                       var market_pir=parseInt(market_value).toString().replace(search_,"9")
                    }
                var coll =parseInt((goodsData[i].goods_sn).slice(10,11)*goodsData[i].settlement_fee)
               let goodsTemplate = '<a href="http://www.youtasc.com/shops/client/toGoodsDetail.action?goodsId='+goodsData[i].goods_id+'" class="goods"><img class="goodsImg" src="'+goodsData[i].goods_cover_url+'"><p class="goodsname"><span><b><i class="hot">热卖</i>'+goodsData[i].goods_name+'</b></span></p><div class="price"><span>市场价:￥'+market_pir+'</span><span></span></div><div class="rate"><span>￥'+goodsData[i].settlement_fee+'</span><p class="coll"><span>'+coll+'</span><img src="images/q.png"/></p></div></a>'
               $(goodsTemplate).appendTo($('.rxgoodslist'))
                    if(i<=5){
                            $(".hot").show()
                        }
             }
            },
            error: function () {
                console.log("错误")
            }
        });
    }
getHotGoods(3)

   
      //搜索
            $('#search').bind('keypress', function (event) {
            if (event.keyCode == "13") {
                var keyword = $(this).val() || '';
                if (keyword == '') {
                    $.alert('搜索关键字不能为空', '<div class="warning"><span class="icon icon_warning"></span></div>');
                    return;
                }
                var search_type = 1;
                if (search_type == '1') {
                    //商品列表
                    window.location.href = "http://www.youtasc.com/shops/client/toGoodsList.action?keyword=" + keyword;
                } else if (search_type == '2') {
                    //拼团列表
                    window.location.href = "http://www.youtasc.com/shops/client/toPinTuanList.action?keyword=" + keyword;
                }
            }
        });
        //获取轮播图
    function getBannerInfo() {
        $.ajax({
            "url": a_url+"/shops/client/activityList.action?location=10",
            "type": "post",
            "contentType": "application/json;charset=utf-8",
            "dataType": "json",
            "success": function (data) {
                console.log(data)
                    var mySwiper = new Swiper('.swiper-container', {
                            autoplay: 5000,//可选选项，自动滑动
                            pagination : '.swiper-pagination',
                            paginationClickable :true
                        }) 
                     for (i = 0; i < data.length; i++) {

                       if(data[i].type == '1'&&data[i].type_param != ''){
                           var template = '<div class="swiper-slide" onclick="toWebsite(\''+data[i].type_param+'\')"><img src="'+data[i].path_url+'"></div>'
                       }else if(data[i].type == '2' && data[i].type_param != ''){
                           var template = '<div class="swiper-slide" onclick="toGoodsDetail(\''+data[i].type_param+'\')"><img src="'+data[i].path_url+'"></div>'
                       }else if(data[i].type == '3' && data[i].type_param != ''){
                         var template = '<div class="swiper-slide" onclick="toPinTuanDetail(\''+data[i].type_param+'\')"><img src="'+data[i].path_url+'"></div>'
                       }

                       $(template).appendTo($('.swiper-wrapper'))
                     }
                     mySwiper.appendSlide($('.swiper-wrapper'));
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                console.log("失败")
            }
        });
    }
    
    function toWebsite(url) {
        window.location.href = url;
    }
    //详情
      function toGoodsDetail(goodsId) {
        window.location.href = a_url+"/shops/client/toGoodsDetail.action?goodsId=" + goodsId;
    }
    //拼团
        function toPinTuanDetail(pintuan_id) {
        window.location.href = a_url+"/shops/client/toPinTuanDetail.action?pinTuanId=" + pintuan_id;
    }
        


  </script>
  <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?3c958aac5a62fb2642dc5b40fede8d5b";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

</html>